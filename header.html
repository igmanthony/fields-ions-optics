document.write(`
<meta charset="UTF-8">
<meta name="viewport", content="width=device-width, initial-scale=1">
<meta name="author", content="Ian Anthony">
<meta name="keywords", content="ion,simulation,mass,spectrometry,fields,ions,optics">
<title>Fields, Ions, and Optics</title>
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest"> 
<link rel="preconnect" href="https://fonts.gstatic.com">
<link
    href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,500;1,500&family=Inconsolata&family=Montserrat:wght@300;400;500;600&display=swap"
    rel="stylesheet">
<link rel="preload" href="style.css" as="style">
<link rel="stylesheet" href="style.css">
<script src="https://kit.fontawesome.com/e01b68e685.js" crossorigin="anonymous"></script>
<!--
    The "playground" and "header" files are Javascript files that write HTML into all documents.
    Forgive me for this abomination of a hack. I can't include HTML but I don't want
    to copy-paste the full playground in to each file. I considered loading all HTML and
    serving it via a single script, rather than the other way around. I think this is less sinful.
-->
<div class="topnav no-print" id="topnav" style="width:100%">
    <div class='flex-child no-print' style="width:100%">
        <div class='title no-print' style="width:100%">SIMULATING FIELDS, IONS, and OPTICS</div>
        <div class='subtitle no-print' style="width:100%">A COMPACT PRIMER ON ION SIMULATION</div>
        <div class="header  no-print">
            <div style="width:100%">
                <div class='sub-header no-print' style="width:100%">Introduction</div>
                <div class="linky" style="width:100%">
                    <div class=spacer><a href="index.html">Forward</a></div>
                    <div class=spacer><a href="simulation_playground.html">The Playground</a></div>
                    <div class=spacer><a href="simulations.html">Simulations</a></div>
                    <div class=spacer><a href="electric_fields.html">Electric fields</a></div>
                    <div class=spacer><a href="charged_particles.html">Charged particles</a></div>
                    <div class=spacer><a href="visualization.html">Visualization</a></div>
                </div>
            </div>
            <div style="width:100%">
                <div class='sub-header no-print' style="width:100%">Implementation</br> </div>
                <div class="linky" style="width:100%">
                    <div class=spacer><a href="laplace_equation.html">Laplace’s equation</a></div>
                    <div class=spacer><a href="electrodynamics.html">Electrodynamics</a></div>
                    <div class=spacer><a href="particle_flight.html">Particle flight*</a></div>
                    <div class=spacer><a href="magnetism.html">Magnetism*</a></div>
                    <div class=spacer><a href="pressure.html">Pressure regimes*</a></div>
                    <div class=spacer><a href="bonus_details.html">Bonus details*</a></div>
                </div>
            </div>
            <div style="width:100%">
                <div class='sub-header no-print' style="width:100%">Building blocks</br></div>
                <div class="linky" style="width:100%">
                    <div class=spacer><a href="focusing.html">Focusing</a></div>
                    <div class=spacer><a href="beams.html">Beams*</a></div>
                    <div class=spacer><a href="guides.html">Guides*</a></div>
                    <div class=spacer><a href="traps.html">Traps*</a></div>
                    <div class=spacer><a href="cooling.html">Cooling*</a></div>
                    <div class=spacer><a href="field_correction.html">Field correction*</a></div><!-- field free regions, thin wire electrodes -->
                    <!-- <div class=spacer><a href="mass_filters.html">Mass filters</a></div> -->
                </div>
            </div>
            <div style="width:100%">
                <div class='sub-header no-print' style="width:100%">Fun with simulations</br></div>
                <div class="linky" style="width:100%">
                    <div class=spacer><a href="filters.html">Filters*</a></div> <!-- sector and quads-->
                    <div class=spacer><a href="tof.html">Time-of-flight*</a></div> <!-- TOF -->
                    <div class=spacer><a href="energy_correction.html">Energy correction*</a></div> <!-- reflectrons and electrostatic correction-->
                    <div class=spacer><a href="resonance.html">Resonance*</a></div> <!-- ICR and orbitraps -->
                    <div class=spacer><a href="funnels.html">Funnels*</a></div> 
                    <div class=spacer><a href="ion_mobility.html">Ion mobility*</a></div>
                </div>
            </div>
            <div style="width:100%">
                <div class='sub-header no-print' style="width:100%">Advanced topics</br></div>
                <div class="linky" style="width:100%">
                    <div class=spacer><a href="accuracy.html">Accuracy*</a></div> <!-- proper simulation setup, design, randomization-->
                    <div class=spacer><a href="data_collection.html">Data collection*</a></div>
                    <div class=spacer><a href="reactions.html">Reactions*</a></div>
                    <!-- Ion-neutral, rrkm, metastable decay, ergodic -->
                    <div class=spacer><a href="3d_simulations.html">3D Simulations*</a></div>
                    <!-- Webassembly, the python script, lua -->
                    <div class=spacer><a href="simion_tips.html">SIMION Tips*</a></div>
                    <!-- <div class=spacer><a href="conclusion.html">Conclusion*</a></div> -->
                    <div class=spacer><a href="code.html">About & code</a></div> <!-- Webassembly, the python script, lua -->
                </div>
            </div>
        </div>
    </div>
</div>

<div id="dummyplayground" class="no-print" style="padding:5px">
    <button type="button" class="fakelapsible no-print" id="empty_none">Simulation Playground</button>
</div>

<!-- PLAYGROUND -->
<div id="playgrounddiv" class="playgrounddiv  no-print">
    <button type="button" class="collapsible  no-print" id="playground" >Simulation Playground</button>
    <div class="tab">
        <!-- BAR -->
        <div class="flex-container">
            <div style="vertical-align:middle">
                <input padding=4 type="range" min="-20000" max="20000" value="0" class="slider" id="voltage_slider"
                    step="1" style="width: 120px">
                <div style="width:100%;text-align: center">
                    <input type="number" id="voltage_input" value=500 size="4" min="-20000" max="20000">
                    <output id="voltage_text">Volts</output>
                </div>
            </div>
            <button id="clear">Blank</button>
            <button id="einzel_lens">Lens</button>
            <button id="tof">Time-of-Flight</button>
            <button id="quadrupole">Quadrupole</button>
            <button id="cyclotron">Cyclotron</button>
            <button id="ion_funnel">Funnel</button>
            <div></div>
            <div id="status" class="status" style="text-align:right;margin-left:120px;padding:0;margin-bottom:0px;">0 μs</div>
        </div>
        <!-- ELECTRODES AND CANVASES -->
        <div class="flex-container">
            <div class="flex-child">
                <div><br></div>
                <div><button class="sidebutton" id="electrode1">Electrode 1</button></div>
                <div><button class="sidebutton" id="electrode2">Electrode 2</button></div>
                <div><button class="sidebutton" id="electrode3">Electrode 3</button></div>
                <div><button class="sidebutton" id="electrode4">Electrode 4</button></div>
                <div>
                    <button id="electrode0" class="sidebutton"
                    style="padding-top:9px;padding-bottom:9px;">Erase</button>
                </div>
                <div><br></div>
                <div>
                    <button id="brush1" class="iconbutton" style="height:3em;"><i class="fa-solid fa-square" style="font-size: x-small;vertical-align: 0.1em"></i></button>
                    <button id="brush2" class="iconbutton" style="height:3em;vertical-align: -0.15em;"><i class="fa-solid fa-window-minimize" style="vertical-align: 0.5em;"></i></button>
                </div>
                <div>
                    <button id="brush3" class="iconbutton" style="height:3em"><i class="fa-regular fa-circle"></i></button>
                    <button id="brush4" class="iconbutton" style="height:3em"><i class="fa-regular fa-square"></i></button>
                </div>

                <div style="margin-top:10px;">
                    <div class="toggle-button-cover">
                    <div class="button-cover">
                        <div class="button r" id="button-2">
                        <input type="checkbox" class="checkbox" id="splattable">
                        <div class="knobs"></div>
                        <div class="layer"></div>
                        </div>
                    </div>
                    </div>
                </div>
                <div>
                    <div class="toggle-button-cover">
                    <div class="button-cover">
                        <div class="button r" id="button-1">
                        <input type="checkbox" class="checkbox" id="dc_mode">
                        <div class="knobs"></div>
                        <div class="layer"></div>
                        </div>
                    </div>
                    </div>
                </div>
                <div><br></div>
                <div><button class="specialbutton" id="update">Update</br>Fields</button></div>
            </div>
            <div>
                <canvas id="electrode_map" width="600" height="600"></canvas>
                <canvas id="electric_field_map" width="600" height="600"></canvas>
            </div>
        </div>
        <!-- ADVANCED -->
        <button type="button" class="collapsible" id="advanced">Advanced</button>
        <div class="tab">
            <div style="align-items:center;" class="flex-container">
                <div style="margin-right:10px">
                    <button id="SIMION_SAVE" class="advancebutton">Save to</br>SIMION</button>
                    <button id="field_lines" class="advancebutton">Draw</br>field</button>
                <!-- </div>
                <div> -->
                    <!-- <button id="apply_high" class="advancebutton">Apply</br>High</button>
                    <button id="apply_low" class="advancebutton">Apply</br>Low</button>
                    <button id="apply_sine" class="advancebutton" style="margin-right:8px">Apply</br>Sine</button> -->
                </div>
                <div>
                    <div>
                        <input type="number" id="sin_frequency" value=1600 size="4" min="0" max="10000">
                        <output style="margin-right:15px">sine f (khz)</output>
                    </div>
                    <div>
                        <select name="bg_gas" id="bg_gas">
                            <option value="28.0">Air</option>
                            <option value="4.0">Helium</option>
                            <option value="40.0">Argon</option>
                            <option value="132.0">Xenon</option>
                        </select>
                        <output style="margin-right:15px">gas</output>
                    </div>
                    <div>
                        <select name="magnetic_field" id="magnetic_field", style='width:69px;'>
                            <option value="none">None</option>
                            <option value="left">Left</option>
                            <option value="right">Right</option>
                        </select>
                        <output style="margin-right:15px">magnet</output>
                    </div>
                </div>
                
                <div>
                    <div>
                        <input type="number" id="offset" value=0 size="4" min="-10000" max="10000">
                        <output style="margin-right:15px">offset V</output>
                    </div>
                    <div>
                        <input type="number" id="pressure" value=0 size="4" min="-10000" , max="10000">
                        <output style="margin-right:15px">pressure Pa</output>
                    </div>
                    <div>
                        <input type="number" id="magnet_field_strength" value=0 size="4" min="-10000" , max="10000">
                        <output style="margin-right:15px">strength T</output>
                    </div>
                </div>

                <div>
                    <div>
                        <input type="number" id="mz_ratio" value=100 size="2" min="0.01" max="100000.0">
                        <output style="margin-right:15px">m/z</output>
                    </div>
                    <div>
                        <input type="number" id="ion_x_velocity" value=0 size="4" min="-10000" , max="10000">
                        <output style="margin-right:15px">x vel m/ms</output>
                    </div>
                    <div>
                        <input type="number" id="ion_y_velocity" value=0 size="4" min="-10000" max="10000">
                        <output style="margin-right:15px">y vel m/ms</output>
                    </div>
                </div>
                
                <div>
                    <pre style="margin-bottom:0px"><code id="splatlog"></code></pre>
                </div>
            </div>
        </div>
    </div>
</div>

`);